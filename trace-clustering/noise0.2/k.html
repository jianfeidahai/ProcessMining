<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="jquery.min.js"></script>
    <script src="springy.js"></script>
    <script src="springyui.js"></script>
</head>
<body>
<script>
    var kruskal = function(params,callback){
        var k = this; // get instance

        k.nodelist = []; // nodelist
        k.callback = callback; // callback function to execute after completion
        k.edges = []; // edgelist
        k.keepedges = []; // edges that we want to keep

        // create edge kects
        params.edges.forEach(function(edge,i){
            k.edges.push({id : i, connecting : [edge[0],edge[1]],nodelist : [edge[0],edge[1]], length : edge[2]});
        });

        // sort edges by length
        k.sort_edges();

        var edges = k.edges.length; // get total number of edges

        // loop all edges
        for(var i = 0; i < edges; i++){
            k.test_edge(); // check every edge
        }
    };

    kruskal.prototype = {

        sort_edges : function(){
            var k = this; // get instance
            k.edges.sort(function(a,b){
                return b.length - a.length; // sort edges in descending order (so smallest can be removed with pop() )
            });
        },

        finished : function(){

            var k = this; // get instance

            var result = [];
            k.keepedges.forEach(function(edge){
                result.push(edge.connecting);
            });

            if(typeof(k.callback) == "function"){
                k.callback( result ); // call callback function and pass result
            }
        },

        test_edge : function(){

            var k = this; // get instance
            var edge = k.edges.pop();
            var current_edges = k.keepedges; // get array of current edges
            var new_edge,found_1,found_2,found;

            if(k.keepedges.length == 0){ // add first edge
                k.keepedges.push(edge);
            }else{
                // check against other edges
                found_1 = [], found_2 = [];
                var found = false; // default value

                k.keepedges.forEach(function(keepedge){
                    if(keepedge.nodelist.indexOf(edge.connecting[0]) > -1 && keepedge.nodelist.indexOf(edge.connecting[1]) > -1){
                        // both nodes are already in edge!!
                        found = true; // set found to true
                    }else if(keepedge.nodelist.indexOf(edge.connecting[0]) > -1){
                        // first node found!
                        found_1.push(keepedge);
                    }else if(keepedge.nodelist.indexOf(edge.connecting[1]) > -1){
                        // second node found
                        found_2.push(keepedge);
                    }
                });

                if(found == false && found_1.length == 0 && found_2.length == 0){ // edge is good to go
                    new_edge = edge;
                    k.keepedges.push(edge); // add edge
                }else if(found == false){ //

                    found_2.forEach(function(keepedge){
                        keepedge.nodelist.push(edge.connecting[0]); // update edge with node 1
                    });

                    found_1.forEach(function(keepedge){
                        keepedge.nodelist.push(edge.connecting[1]); // update edge with node 2
                    });

                    new_edge = edge;
                    k.keepedges.push(edge); // add edge
                }
            }

            if(found == false){ // new edge was added -> clean list
                k.clean_edgelist(current_edges,new_edge);
            }

            if(k.edges.length == 0){
                k.finished(); // execution completed
            }
        },

        clean_edgelist : function(old_edges,new_edge){

            var k = this; // get instance
            var n1_tmp,n2_tmp,count; // define vars used in loop

            // loop edges (excluding last)
            old_edges.forEach(function(check_edge){

                n1_tmp  = []; // <- nodes that are contained in new_edge but NOT check_edge
                n2_tmp  = []; // <- nodes that are contained in check_edge but NOT new_edge
                count = 0; // count overlapping nodes between new_edge and check_edge

                // check for overlap
                new_edge.nodelist.forEach(function(n1){
                    if(check_edge.nodelist.indexOf(n1) > -1){ // n2 contains n1
                        count++;
                    }else{ // n2 does not contain n1
                        n2_tmp.push(n1);
                    }
                });

                if(count > 1){ // join both edges!!

                    check_edge.nodelist.forEach(function(n2){
                        if(new_edge.nodelist.indexOf(n2) == -1){ // n1 does not contain n2
                            n1_tmp.push(n2);
                        }
                    });

                    new_edge.nodelist = new_edge.nodelist.concat(n1_tmp); // concat with differences from check_edge
                    check_edge.nodelist = check_edge.nodelist.concat(n2_tmp); // concat with differences from new_edge
                }
            });
        }
    };

    k = new kruskal({
        nodes : ["0","1","2","3",'4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26'],
        edges : [
            ["0","1",0.8884615384615385],
            ["0","2",0.6],
            ["0","3",0.7227272727272728],
            ["0","4",0.9884615384615384],
            ["0","5",0.9045454545454547],
            ["0","6",0.6807692307692307],
            ["0","7",0.8136363636363637],
            ["0","8",0.49444444444444435],
            ["0","9",0.7576923076923076],
            ["0","10",0.9000000000000002],
            ["0","11",0.7944444444444445],
            ["0","12",0.8000000000000002],
            ["0","13",0.6576923076923077],
            ["0","14",0.9884615384615386],
            ["0","15",0.9115384615384615],
            ["0","16",0.9500000000000001],
            ["0","17",0.7000000000000001],
            ["0","18",0.9083333333333334],
            ["0","19",0.49999999999999994],
            ["0","20",0.575],
            ["0","21",0.9083333333333334],
            ["0","22",0.6583333333333333],
            ["0","23",0.8000000000000002],
            ["0","24",0.7000000000000001],
            ["0","25",0.39999999999999997],
            ["0","26",0.8250000000000002],
            ["1","2",0.8115384615384614],
            ["1","3",0.3006993006993006],
            ["1","4",0.3846153846153846],
            ["1","5",0.5454545454545454],
            ["1","6",0.46153846153846156],
            ["1","7",0.4405594405594406],
            ["1","8",0.9059829059829059],
            ["1","9",0.6153846153846153],
            ["1","10",0.7576923076923078],
            ["1","11",0.675213675213675],
            ["1","12",0.7576923076923076],
            ["1","13",0.46153846153846156],
            ["1","14",0.3076923076923077],
            ["1","15",0.23076923076923078],
            ["1","16",0.5769230769230769],
            ["1","17",0.8115384615384614],
            ["1","18",0.5416666666666666],
            ["1","19",0.7346153846153846],
            ["1","20",0.3814102564102563],
            ["1","21",0.3108974358974358],
            ["1","22",0.5416666666666665],
            ["1","23",0.5038461538461538],
            ["1","24",0.326923076923077],
            ["1","25",0.5576923076923076],
            ["1","26",0.15064102564102555],
            ["2","3",0.7136363636363635],
            ["2","4",0.8115384615384614],
            ["2","5",0.9045454545454547],
            ["2","6",0.6576923076923077],
            ["2","7",0.7136363636363636],
            ["2","8",0.4944444444444443],
            ["2","9",0.6576923076923077],
            ["2","10",0.8000000000000002],
            ["2","11",0.6944444444444445],
            ["2","12",0.8000000000000002],
            ["2","13",0.6346153846153845],
            ["2","14",0.8884615384615383],
            ["2","15",0.8115384615384614],
            ["2","16",0.7666666666666666],
            ["2","17",0.49999999999999994],
            ["2","18",0.725],
            ["2","19",0.39999999999999997],
            ["2","20",0.5583333333333333],
            ["2","21",0.725],
            ["2","22",0.5583333333333333],
            ["2","23",0.6],
            ["2","24",0.6],
            ["2","25",0.39999999999999997],
            ["2","26",0.725],
            ["3","4",0.46853146853146843],
            ["3","5",0.5454545454545455],
            ["3","6",0.3006993006993006],
            ["3","7",0.45454545454545453],
            ["3","8",0.717171717171717],
            ["3","9",0.4545454545454545],
            ["3","10",0.8136363636363637],
            ["3","11",0.717171717171717],
            ["3","12",0.8136363636363637],
            ["3","13",0.3146853146853146],
            ["3","14",0.3356643356643356],
            ["3","15",0.3146853146853146],
            ["3","16",0.6287878787878787],
            ["3","17",0.7136363636363635],
            ["3","18",0.5037878787878788],
            ["3","19",0.5318181818181817],
            ["3","20",0.17045454545454541],
            ["3","21",0.3371212121212121],
            ["3","22",0.3371212121212121],
            ["3","23",0.5318181818181817],
            ["3","24",0.35],
            ["3","25",0.35],
            ["3","26",0.17045454545454541],
            ["4","5",0.3776223776223776],
            ["4","6",0.6153846153846153],
            ["4","7",0.5944055944055943],
            ["4","8",0.7521367521367519],
            ["4","9",0.46153846153846156],
            ["4","10",0.5807692307692308],
            ["4","11",0.4871794871794871],
            ["4","12",0.5807692307692307],
            ["4","13",0.46153846153846145],
            ["4","14",0.46153846153846156],
            ["4","15",0.3846153846153846],
            ["4","16",0.4166666666666667],
            ["4","17",0.7346153846153846],
            ["4","18",0.6185897435897436],
            ["4","19",0.5807692307692308],
            ["4","20",0.5416666666666666],
            ["4","21",0.15064102564102555],
            ["4","22",0.3878205128205127],
            ["4","23",0.326923076923077],
            ["4","24",0.4807692307692309],
            ["4","25",0.7346153846153846],
            ["4","26",0.3044871794871794],
            ["5","6",0.7622377622377622],
            ["5","7",0.6363636363636365],
            ["5","8",0.7171717171717172],
            ["5","9",0.6083916083916083],
            ["5","10",0.5409090909090909],
            ["5","11",0.4444444444444445],
            ["5","12",0.45000000000000007],
            ["5","13",0.7762237762237761],
            ["5","14",0.5944055944055944],
            ["5","15",0.5314685314685313],
            ["5","16",0.5454545454545454],
            ["5","17",0.8136363636363637],
            ["5","18",0.7537878787878788],
            ["5","19",0.6318181818181817],
            ["5","20",0.6704545454545455],
            ["5","21",0.25378787878787884],
            ["5","22",0.5037878787878788],
            ["5","23",0.3590909090909091],
            ["5","24",0.5409090909090909],
            ["5","25",0.8136363636363637],
            ["5","26",0.42045454545454547],
            ["6","7",0.6853146853146853],
            ["6","8",0.675213675213675],
            ["6","9",0.3846153846153847],
            ["6","10",0.9884615384615384],
            ["6","11",0.9059829059829057],
            ["6","12",0.9115384615384615],
            ["6","13",0.23076923076923078],
            ["6","14",0.5384615384615384],
            ["6","15",0.46153846153846156],
            ["6","16",0.8012820512820512],
            ["6","17",0.7346153846153843],
            ["6","18",0.6891025641025641],
            ["6","19",0.5038461538461539],
            ["6","20",0.15064102564102555],
            ["6","21",0.5352564102564102],
            ["6","22",0.3044871794871794],
            ["6","23",0.7346153846153846],
            ["6","24",0.5807692307692308],
            ["6","25",0.3500000000000001],
            ["6","26",0.3814102564102563],
            ["7","8",0.7878787878787878],
            ["7","9",0.8251748251748253],
            ["7","10",0.6227272727272728],
            ["7","11",0.515151515151515],
            ["7","12",0.6318181818181818],
            ["7","13",0.6853146853146853],
            ["7","14",0.5314685314685316],
            ["7","15",0.4405594405594406],
            ["7","16",0.6212121212121212],
            ["7","17",0.7136363636363636],
            ["7","18",0.5795454545454545],
            ["7","19",0.6227272727272727],
            ["7","20",0.5795454545454545],
            ["7","21",0.49621212121212127],
            ["7","22",0.7462121212121212],
            ["7","23",0.35],
            ["7","24",0.16818181818181818],
            ["7","25",0.4409090909090908],
            ["7","26",0.3295454545454546],
            ["8","9",0.5213675213675213],
            ["8","10",0.5944444444444444],
            ["8","11",0.33333333333333337],
            ["8","12",0.5944444444444443],
            ["8","13",0.6410256410256407],
            ["8","14",0.982905982905983],
            ["8","15",0.9059829059829059],
            ["8","16",0.6944444444444444],
            ["8","17",0.4944444444444443],
            ["8","18",0.8194444444444444],
            ["8","19",0.19444444444444436],
            ["8","20",0.5694444444444444],
            ["8","21",0.6527777777777777],
            ["8","22",0.40277777777777773],
            ["8","23",0.4944444444444443],
            ["8","24",0.6944444444444444],
            ["8","25",0.39444444444444443],
            ["8","26",0.8194444444444443],
            ["9","10",0.8346153846153846],
            ["9","11",0.7521367521367519],
            ["9","12",0.7346153846153846],
            ["9","13",0.3846153846153847],
            ["9","14",0.6923076923076923],
            ["9","15",0.6153846153846153],
            ["9","16",0.6538461538461536],
            ["9","17",0.6576923076923077],
            ["9","18",0.6576923076923077],
            ["9","19",0.326923076923077],
            ["9","20",0.3044871794871794],
            ["9","21",0.3814102564102563],
            ["9","22",0.15064102564102555],
            ["9","23",0.5576923076923076],
            ["9","24",0.7115384615384613],
            ["9","25",0.4807692307692308],
            ["9","26",0.5352564102564102],
            ["10","11",0.2944444444444444],
            ["10","12",0.49999999999999994],
            ["10","13",0.9884615384615384],
            ["10","14",0.8346153846153848],
            ["10","15",0.7346153846153846],
            ["10","16",0.2833333333333334],
            ["10","17",0.7000000000000001],
            ["10","18",0.7416666666666667],
            ["10","19",0.6],
            ["10","20",0.9083333333333334],
            ["10","21",0.4916666666666667],
            ["10","22",0.7416666666666668],
            ["10","23",0.3],
            ["10","24",0.49999999999999994],
            ["10","25",0.8000000000000002],
            ["10","26",0.6583333333333334],
            ["11","12",0.3944444444444444],
            ["11","13",0.9059829059829059],
            ["11","14",0.7521367521367521],
            ["11","15",0.6410256410256407],
            ["11","16",0.4444444444444445],
            ["11","17",0.5944444444444443],
            ["11","18",0.6527777777777777],
            ["11","19",0.4944444444444443],
            ["11","20",0.8194444444444443],
            ["11","21",0.40277777777777773],
            ["11","22",0.6527777777777777],
            ["11","23",0.19444444444444436],
            ["11","24",0.39444444444444443],
            ["11","25",0.6944444444444444],
            ["11","26",0.5694444444444444],
            ["12","13",0.9115384615384615],
            ["12","14",0.8346153846153846],
            ["12","15",0.7346153846153846],
            ["12","16",0.6166666666666666],
            ["12","17",0.7000000000000001],
            ["12","18",0.8250000000000002],
            ["12","19",0.49999999999999994],
            ["12","20",0.8250000000000001],
            ["12","21",0.49166666666666664],
            ["12","22",0.6583333333333333],
            ["12","23",0.3],
            ["12","24",0.49999999999999994],
            ["12","25",0.7000000000000001],
            ["12","26",0.6583333333333333],
            ["13","14",0.5384615384615384],
            ["13","15",0.46153846153846156],
            ["13","16",0.8076923076923076],
            ["13","17",0.7346153846153846],
            ["13","18",0.6955128205128205],
            ["13","19",0.4807692307692308],
            ["13","20",0.15064102564102555],
            ["13","21",0.5416666666666666],
            ["13","22",0.3044871794871794],
            ["13","23",0.7346153846153846],
            ["13","24",0.5807692307692308],
            ["13","25",0.326923076923077],
            ["13","26",0.3878205128205127],
            ["14","15",0.3076923076923077],
            ["14","16",0.641025641025641],
            ["14","17",0.8884615384615384],
            ["14","18",0.6057692307692307],
            ["14","19",0.8115384615384614],
            ["14","20",0.439102564102564],
            ["14","21",0.3621794871794871],
            ["14","22",0.592948717948718],
            ["14","23",0.5807692307692308],
            ["14","24",0.42692307692307696],
            ["14","25",0.6576923076923077],
            ["14","26",0.20833333333333331],
            ["15","16",0.5705128205128205],
            ["15","17",0.8115384615384617],
            ["15","18",0.5352564102564102],
            ["15","19",0.7346153846153846],
            ["15","20",0.3878205128205128],
            ["15","21",0.3044871794871794],
            ["15","22",0.5416666666666666],
            ["15","23",0.4807692307692308],
            ["15","24",0.326923076923077],
            ["15","25",0.5807692307692308],
            ["15","26",0.15064102564102555],
            ["16","17",0.6833333333333333],
            ["16","18",0.5416666666666666],
            ["16","19",0.6000000000000001],
            ["16","20",0.7083333333333333],
            ["16","21",0.29166666666666663],
            ["16","22",0.5416666666666666],
            ["16","23",0.35000000000000003],
            ["16","24",0.5166666666666667],
            ["16","25",0.7666666666666666],
            ["16","26",0.45833333333333337],
            ["17","18",0.6416666666666667],
            ["17","19",0.39999999999999997],
            ["17","20",0.6416666666666666],
            ["17","21",0.6416666666666667],
            ["17","22",0.5583333333333333],
            ["17","23",0.49999999999999994],
            ["17","24",0.6],
            ["17","25",0.49999999999999994],
            ["17","26",0.725],
            ["18","19",0.725],
            ["18","20",0.5833333333333334],
            ["18","21",0.49999999999999994],
            ["18","22",0.6666666666666667],
            ["18","23",0.5583333333333332],
            ["18","24",0.47500000000000003],
            ["18","25",0.6416666666666667],
            ["18","26",0.41666666666666663],
            ["19","20",0.3916666666666667],
            ["19","21",0.47500000000000014],
            ["19","22",0.22500000000000003],
            ["19","23",0.3],
            ["19","24",0.49999999999999994],
            ["19","25",0.2],
            ["19","26",0.6416666666666667],
            ["20","21",0.4166666666666667],
            ["20","22",0.16666666666666666],
            ["20","23",0.6416666666666666],
            ["20","24",0.4750000000000001],
            ["20","25",0.22500000000000003],
            ["20","26",0.24999999999999997],
            ["21","22",0.24999999999999997],
            ["21","23",0.22500000000000003],
            ["21","24",0.3916666666666667],
            ["21","25",0.6416666666666667],
            ["21","26",0.16666666666666666],
            ["22","23",0.4750000000000001],
            ["22","24",0.6416666666666666],
            ["22","25",0.3916666666666667],
            ["22","26",0.4166666666666667],
            ["23","24",0.2],
            ["23","25",0.49999999999999994],
            ["23","26",0.3916666666666667],
            ["24","25",0.3],
            ["24","26",0.22500000000000003],
            ["25","26",0.47500000000000014]
        ]
    },function(edgelist){

        console.log(edgelist);

        var graph = new Springy.Graph();

        graph.addNodes('trace0','trace1','trace2','trace3','trace4','trace5','trace6','trace7','trace8','trace9','trace10','trace11','trace12','trace13','trace14','trace15','trace16','trace17','trace18','trace19','trace20','trace21','trace22','trace23','trace24','trace25','trace26','trace27');
        for (let i=0;i<edgelist.length;i++) {

            graph.addEdges(
                [`trace${edgelist[i][0]}`, `trace${edgelist[i][1]}`, {color: '#000'}]
            );
        }

        jQuery(function(){
            var springy = jQuery('#springydemo').springy({
                graph: graph
            });
        });

    });
</script>
<canvas id="springydemo" width="640" height="480" />
</body>
</html>